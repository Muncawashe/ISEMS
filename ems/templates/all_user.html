{% extends 'super_base.html' %}
{% block title %}
Records
{% endblock %}

{% block content %}
    <div class="container-fluid">
      <h1 class="center-text">All employeeloyees</h1>
        <hr>
        <input type="text" id="searchInput" onkeyup="filterTable()" placeholder="Search for names.." class="">
        <table class="table" id="employeeTable">
            <thead>
              <tr>
                <th scope="col">ID</th>
                <th scope="col">First Name</th>
                <th scope="col">Last Name</th>
                <th scope="col">Phone</th>
                <th scope="col">Dept Name</th>
                <th scope="col">Role</th>
                <th scope="col">View Profile</th>
                <th scope="col">Update</th>
                <th scope="col">Delete</th>
              </tr>
            </thead>
            {% for employee in employees %}
            <tbody>
                
              <tr>
                <td>{{employee.id}}</td>
                <td>{{employee.first_name}}</td>
                <td>{{employee.last_name}}</td>
                <td>{{employee.phone}}</td>
                <td>{{employee.dept.name}}</td>
                <td>{{employee.role.name}}</td>
                <td>
                  <p>{{ object.name }} <a href="{% url 'view_profile' employee.id %}" class="view-btn">ViewProfile</a></p>
              </td> 
                <td>
                    <p>{{ object.name }} <a href="{% url 'update_user' employee.id %}" class="update-btn">Update</a></p>
                </td> 
                <td>
                  <p>{{ object.name }} <a href="{% url 'delete_user_id' employee.id %}" class="delete-btn" onclick="return confirmDelete()">Delete</a></p>
              </td>
              </tr>
              
            </tbody>
            {% endfor %}
          </table>
    </div>

    <script>
      // Function to filter the table
      function filterTable() {
        var input, filter, table, tr, td, i, j, txtValue;
        input = document.getElementById("searchInput");
        filter = input.value.toUpperCase();
        table = document.getElementById("employeeTable");
        tr = table.getElementsByTagName("tr");
        for (i = 1; i < tr.length; i++) {
          tr[i].style.display = "none";
          td = tr[i].getElementsByTagName("td");
          for (j = 0; j < td.length; j++) {
            if (td[j]) {
              txtValue = td[j].textContent || td[j].innerText;
              if (txtValue.toUpperCase().indexOf(filter) > -1) {
                tr[i].style.display = "";
                break;
              }
            }
          }
        }
      }
    
      // Function to confirm deletion
      function confirmDelete() {
        return confirm("Are you sure you want to delete this employee?");
      }

      document.addEventListener('DOMContentLoaded', function() {
        {% if messages %}
            {% for message in messages %}
            alert("{{ message }}");
            {% endfor %}
        {% endif %}
        });
    </script>
    
    <style>
      .view-btn, .update-btn, .delete-btn {
        padding: 5px 10px;
        text-decoration: none;
      }
    
      .center-text {
        text-align: center;
      }
    
      .table {
        margin-top: 20px;
      }
    </style>
{% endblock %}